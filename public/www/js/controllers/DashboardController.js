// Generated by CoffeeScript 1.10.0
app.controller('DashboardController', function($scope, $http, $timeout, $window) {
  $scope.checked = true;
  var timeForMainSlide = 2000 * 60;
  var timeForSecondSlide = 1000 * 60;
  var homeSlider = document.getElementById("home-slide");
  var secondSlider = document.getElementById("second-slide");
  var href = window.location.href

  $http({
    method: 'GET',
    url: '/api/news'
  }).then(function(response) {
    $scope.images = response.data.body
    if ($scope.images.length > 0){
      $scope.image = $scope.images[0].image.image.url;
      slider();
    }
  });

  function slider(){
    setTimeout(function(){
      $scope.$apply(function () {
        $scope.image = $scope.images[0].image.image.url;
        homeSlider.className = "out";
        secondSlider.className = "in";
      });

      var i = 0;

      var idInterval = setInterval(function () {
        i++;
        if (i < $scope.images.length){
          $scope.$apply(function () {
            $scope.image = $scope.images[i].image.image.url;
          });
        } else {
          clearInterval(idInterval);
          $scope.$apply(function () {
            homeSlider.className = "in";
            secondSlider.className = "out";
            slider();
          });
        }
      }, timeForSecondSlide);
    }, timeForMainSlide);
  }
});
