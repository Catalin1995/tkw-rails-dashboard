// Generated by CoffeeScript 1.10.0
app.controller('ProjectsPerWeekController', function($scope, $http, $timeout, $window) {
  $scope.aux = window.location.href.split("#")[1];
  $scope.weekIndex = $scope.aux.split('/')[5];
  $scope.year = $scope.aux.split('/')[7];
  $scope.week = {};

  $scope.getDate = function(day){
    var date = new Date($scope.week.first_day);
    date.setDate(date.getDate() + Number(day));

    var year = date.getFullYear(),
        month = date.getMonth() + 1,
        day = date.getDate();

    return "(" + year + "-" + month + "-" + day + ")";
  }

  return $http({
    method: 'GET',
    url: '/api/projects/graph'
  }).then(function(response) {
    $scope.data = response.data.body.graph;
    $scope.week = $scope.data[$scope.year][$scope.weekIndex];
    $scope.date = new Date($scope.week.first_day);
  });
});
